ARCH=@ARCH@
LIBDIR=@libdir@
INCLUDES=-I. -I../../include -I../../xbmc/addons
DEFINES+=
CXXFLAGS=-fPIC
LIBNAME=libXBMC_addon
OBJS=$(LIBNAME).o

LIB_SHARED=$(LIBNAME).so.0.0.1
LIB_STATIC=$(LIBNAME).a

all: $(LIB_SHARED) $(LIB_STATIC)

$(LIB_SHARED): $(OBJS)
ifeq ($(findstring osx,$(ARCH)), osx)
	@export MACOSX_DEPLOYMENT_TARGET=10.4
	$(CXX) -bundle -shared -flat_namespace -undefined suppress -o $(LIB_SHARED) $(OBJS)
	../../tools/Mach5/wrapper.rb $@;mv output.so $@
else
	$(CXX) $(CFLAGS) -shared -g -o $(LIB_SHARED) $(OBJS)
endif
	@ln -sf $(LIB_SHARED) $(LIBNAME).so.0
	@ln -sf $(LIB_SHARED) $(LIBNAME).so

$(LIB_STATIC): $(OBJS)
	$(AR) cq $@ $(OBJS)

CLEAN_FILES = \
	$(LIBNAME).so.0.0.1 \
	$(LIBNAME).so.0 \
	$(LIBNAME).so \
	$(LIBNAME).a \

DISTCLEAN_FILES= \
	Makefile \

include ../../Makefile.include
