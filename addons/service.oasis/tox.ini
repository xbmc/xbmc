[tox]

# Python environments
envlist = py310
skipsdist = True

[testenv]

# Install pytest in the virtualenv where commands will be executed
deps =
    black==22.12.0
    flake8==6.0.0
    flake8-blind-except==0.2.1
    flake8-builtins==2.1.0
    flake8-comprehensions==3.10.1
    flake8-deprecated==2.0.1
    flake8-docstrings==1.6.0
    flake8-import-order==0.18.2
    flake8-logging-format==0.9.0
    flake8-quotes==3.3.2
    isort==5.11.4
    mypy==0.991

# Needed for some Python setups
#install_command=pip install --user {opts} {packages}

commands =
    # NOTE: you can run any command line tool here - not just tests
    # *_pb2.py are auto-generated / compiled from Google's protobuf definitions
    black --check .
    flake8 .
    isort --check-only .
    mypy .

[flake8]

ignore =
    # Allow class attributes to shadow python builtins
    A003,

    # Eventually we should fix these, but for now ignore blind Except statements
    # TODO: Fix all blind excepts when migrating to Python 3
    B902,

    # Newline after class definition conflicts with black
    CNL100,

    # TODO: Add docstrings in public classes, methods, functions and __init__
    D100,
    D101,
    D102,
    D103,
    D104,

    # Black already controls line length, assume the remaining ones are fine (prob. strings)
    E501,

    # Import order is managed by isort
    I100,
    I201,

    # Black controls single vs double quotes
    Q000,

    # Ignore whitespace added by black before/after binary operators
    W503,
    W504,

[isort]

# Set first party to modules in this package's modules/ folder
known_first_party = oasis

# Group modules from other packages as third party
default_section = THIRDPARTY

# Removing double lines conflicts with black
lines_after_imports = 2

# Use single line imports for cleaner git history and fewer black conflicts
force_single_line = True

# Skip tox environment
skip = .tox

# Increase line length to match black
line_length = 88
